## π“ 1. λ„¤νΈμ›ν¬ λ³΄μ•μ΄λ€ λ¬΄μ—‡μΈκ°€?
λ„¤νΈμ›ν¬ ν†µμ‹ μ€ μ  3μκ°€ κ°μ…ν•  μ μλ” λ¶μ•μ „ν• λ§¤μ²΄λ¥Ό ν†µν•΄ λ©”μ‹μ§€λ¥Ό μ£Όκ³  λ°›λ”λ‹¤. 

λ„¤νΈμ›ν¬ ν†µμ‹ μ—μ„λ” λ‹¤μκ³Ό κ°™μ€ κ³ λ ¤μ‚¬ν•­μ΄ μ΅΄μ¬ν•λ‹¤
1. λ„μ²­(interception): κ²½λ΅ μƒμ κ³µκ²©μκ°€ λ©”μ‹μ§€ λ‚΄μ©μ„ ν›”μ³λ³Ό μ μλ‹¤
    - μ•”νΈν™”
2. μ„μ¥(Camouflage): μ†΅μ‹ μ λλ” μμ‹ μλ¥Ό μ„μ¥ν•μ—¬ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ±°λ‚ λ°›μ„ μ μλ‹¤
    - λ©”μ‹μ§€ μΈμ¦ μ½”λ“ or μ „μμ„λ…
3. λ³€μ΅°(falsification): μ¤‘κ°„μ—μ„ λ©”μ‹μ§€ λ‚΄μ©μ΄ λ³€κ²½λ  μ μλ‹¤
    - λ©”μ‹μ§€ μΈμ¦ μ½”λ“ or μ „μμ„λ…
4. μ‚¬ν›„ λ¶€μΈ(posthumous denial): μ†΅μ‹ μκ°€ λ³΄λ‚Έ λ©”μ‹μ§€ λ‚΄μ©μ„ λ¶€μΈν•  μ μλ‹¤
    - μ „μμ„λ…

μ•μ „ν• ν†µμ‹ μ— μ”κµ¬λλ” νΉμ„±μ€ λ‹¤μκ³Ό κ°™λ‹¤
- κΈ°λ°€μ„±(confidentiality)
    - μ†΅μ‹ μμ™€ μ§€μ •λ μμ‹ μλ§μ΄ λ©”μ‹μ§€ λ‚΄μ©μ„ μ΄ν•΄ν•  μ μμ–΄μ•Ό ν•λ‹¤
    - λ„μ²­μκ°€ λ©”μ‹μ§€λ¥Ό κ°€λ΅μ±„λ”λΌλ„ ν•΄μ„ν•  μ μ—†λ„λ΅ μ•”νΈν™”λμ–΄ μμ–΄μ•Ό ν•λ‹¤
- λ©”μ‹μ§€ λ¬΄κ²°μ„±(message integrity)
    - λ©”μ‹μ§€λ” μ¤‘κ°„μ— λ³€κ²½λμ–΄μ„λ” μ•λλ‹¤
    - μ²΄ν¬μ„¬(checksum)μ„ ν™•μ¥ν•μ—¬ λ¬΄κ²°μ„±μ„ μ κ³µν•  μ μλ‹¤
- μΆ…λ‹¨μ  μΈμ¦(endpoint authentication)
    - ν†µμ‹ μ— μ°Έμ—¬ν•λ” μƒλ€κ°€ λ„κµ¬μΈμ§€ ν™•μΈν•κΈ° μ„ν•΄ μ‹ μ›μ„ ν™•μΈν•  μ μμ–΄μ•Ό ν•λ‹¤
    - μ„λ²„λ” μμ›μ— μ ‘κ·Όν•λ” μ‚¬μ©μκ°€ μμ›μ μ†μ μμΈμ§€ ν™•μΈν•  μ μμ–΄μ•Ό ν•λ‹¤
- μ΄μ λ³΄μ•(operational security)
    - λ„¤νΈμ›ν¬ κ³µκ²©μλ” νΈμ¤νΈ μ»΄ν“¨ν„°μ— λ‹¤μ–‘ν• λ°©μ‹μΌλ΅ λ³΄μ• κ³µκ²©μ„ μ‹λ„ν•  μ μλ‹¤
    - λ°©ν™”λ²½μ΄λ‚ μΉ¨μ…μ κ°μ§€ μ‹μ¤ν…μ€ μ΄λ¥Ό μλ°©ν•΄μ¤€λ‹¤

## π“ 2. μ•”νΈμ μ›λ¦¬ : κΈ°λ°€μ„±(confidentiality)
- ν‰λ¬Έ(plain text, cleartext)
    - μ•”νΈν™”λμ§€ μ•μ€ μ›λ ν•νƒμ λ©”μ‹μ§€
    - ex. "Bob, I love you. Alice."
- μ•”νΈλ¬Έ(ciphertext)
    - ν‰λ¬Έμ— μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•΄ μ•”νΈν™”
    - λ‹¤λ¥Έ μΉ¨μ…μκ°€ ν•΄μ„ν•  μ μ—†λ‹¤
    - ν‰λ¬Έ(m) + ν‚¤($K_A$) = μ•”νΈλ¬Έ($K_A(m)$)
- λ³µνΈν™”
    - μ•”νΈλ¬Έ($K_A(m)$) + ν‚¤($K_B$) = $K_B(K_A(m))$ = $m$
- λ€μΉ­ν‚¤ μ‹μ¤ν…
    - μ†΅μ‹ μμ™€ μμ‹ μλ” λ™μΌν• ν‚¤λ¥Ό μ‚¬μ©
    - ν‚¤λ” λ‘ μ‚¬μ΄μ λΉ„λ°€
- κ³µκ°ν‚¤ μ‹μ¤ν…
    - ν• μμ ν‚¤λ¥Ό μ‚¬μ©
    - κ³µκ°ν‚¤λ” λ„κµ¬λ‚ μ• μ μλ” ν‚¤
    - κ°μΈν‚¤λ” μ†΅/μμ‹ μ μ¤‘ ν• λ…λ§ κ°€μ§

### 2.1 λ€μΉ­ν‚¤ μ•”νΈν™”
#### 1) μΉ΄μ΄μ‚¬λ¥΄ μ•”νΈ(Caesar Cipher)
- ν‰λ¬Έμ κ° μ² μλ¥Ό μ•νλ²³ μμ„λ΅ kλ²μ§Έ λ’¤μ— μ¤λ” μ² μλ΅ λ€μΉ
- μΉ΄μ΄μ‚¬λ¥΄ μ•”νΈλ” 25κ°€μ§€ ν‚¤λ§μ΄ κ°€λ¥ν•κΈ° λ•λ¬Έμ— ν•΄λ…ν•λ” λ° μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬μ§€ μ•λ”λ‹¤λ” λ¬Έμ κ°€ μλ‹¤
- k=3
    - a -> d, b -> e ...
    - ex. "bob, i love you. alice." -> `"ere, l oryh brx. dolfh."`

#### 2) λ‹¨μΌ λ¬Έμ λ€μ‘ μ•”νΈ(monoalphabetic cipher)
- μΌμ •ν• κ·μΉ™μ— λ”°λΌ λ€μΉν•λ” λ€μ‹ , κ° μ² μλ“¤μ„ κ³ μ ν• λ€μ‘ κΈ€μλ΅ λ³€ν™
- μ²« κΈ€μλ” 26κ° κΈ€μμ—, λ‘ λ²μ§Έ κΈ€μλ” λ‚λ¨Έμ§€ 25κ° κΈ€μμ— ... λ€μ‘ν•  μ μμ
    - $26!$ κ°€μ§€ ν‚¤κ°€ κ°€λ¥ν•λ‹¤
- ν†µκ³„ λ¶„μ„μ„ ν†µν•΄ μμ£Ό λ‚μ¤λ” μ² μλ‚ λ‹¨μ–΄ λ“±μ„ ν†µν•΄ μ μ¶”ν•  μ μλ‹¤λ” λ¬Έμ κ°€ μλ‹¤
- μΉ¨μ…μκ°€ κ°–λ” μ •λ³΄μ— λ”°λΌ μ„Έ κ°€μ§€ μ‹λ‚λ¦¬μ¤λ¥Ό μƒκ°ν•΄λ³Ό μ μλ‹¤
    1. μ•”νΈλ¬Έλ§μ„ μ΄μ©ν• κ³µκ²©(ciphertext-only attack)
        - μ–΄λ– ν• μ‚¬μ „ μ •λ³΄λ„ μ—†μ΄ κ°€λ΅μ± μ•”νΈλ¬Έμ—λ§ μ ‘κ·Όν•  μ μλ” κ²½μ°
        - ν†µκ³„λ¶„μ„μ„ ν†µν•΄ ν•΄μ„ν•  μ μλ‹¤
    2. μ•λ ¤μ§„ ν‰λ¬Έ κ³µκ²©(known-plaintext attack)
        - μ•”νΈλ¬Έμ μΌλ¶€ λ§¤ν•‘ μ •λ³΄λ¥Ό μ•κ³  μλ” κ²½μ°
        - κ²½μ°μ μκ°€ ν™•μ—°ν μ¤„μ–΄λ“¤κ² λλ‹¤
    3. μ„ νƒ ν‰λ¬Έ κ³µκ²©(chosen-plaintext attack)
        - νΉμ • ν‰λ¬Έ λ©”μ‹μ§€λ¥Ό μ„ νƒν•μ—¬ μ΄μ— λ€μ‘ν•λ” μ•”νΈλ¬Έμ„ μ–»μ„ μ μλ” κ²½μ°
        - λ°μ „λ μ•”νΈν™” κΈ°λ²•λ“¤μ—μ„λ” μ„ νƒ ν‰λ¬Έ κ³µκ²©μ΄ μ ν¨ν•μ§€ μ•μ

#### 3) λ‹¤μ¤‘ λ¬Έμ λ€μ‘ μ•”νΈν™”(polyalphabetic encryption)
- μ—¬λ¬ κ°μ λ‹¨μΌ λ¬Έμ λ€μ‘λ²•μ„ κ°€μ§€κ³  μ„μΉμ— λ”°λΌ λ‹¤λ¥Έ λ‹¨μΌ λ¬Έμ λ€μ‘ μ•”νΈλ¥Ό μ‚¬μ©
- κ°™μ€ λ¬ΈμλΌλ„ μ„μΉμ— λ”°λΌ λ‹¤λ¥΄κ² μ•”νΈν™”λ¨

#### 4) λ€μΉ­ν‚¤ μ•”νΈν™”: λΈ”λ΅ μ•”νΈν™”(block ciphers)
- PGP(λ³΄μ• μ „μ λ©”μΌ), SSL(λ³΄μ• TCP), IPSec(λ³΄μ• λ„¤νΈμ›ν¬ κ³„μΈµ μ „μ†΅) λ“±μ— μ‚¬μ©
- λ©”μ‹μ§€λ¥Ό kλΉ„νΈμ λΈ”λ΅ λ‹¨μ„λ΅ μ•”νΈν™”
    - ex. k=64λΌλ©΄, 64λΉ„νΈ λ‹¨μ„λ΅ μ•”νΈν™”
- kλΉ„νΈ λΈ”λ΅μ ν‰λ¬Έμ„ kλΉ„νΈ λΈ”λ΅μ μ•”νΈλ¬ΈμΌλ΅ λ€μ‘
    - ex. k=3μ΄λΌλ©΄, 3λΉ„νΈ μ…λ ¥μ— λ€μ‘ν•λ” 3λΉ„νΈ μ¶λ ¥μΌλ΅ λ§¤ν•‘μ‹μΌμ¤
    - μΌλ€μΌ μ‚¬μƒμ„ κ°€μ§„λ‹¤
- ν‚¤λ” μ‚¬μƒν‘κ°€ λκ³ , μ‚¬μƒν‘λ¥Ό μ΄μ©ν•΄ λ©”μ‹μ§€λ¥Ό μ•”νΈν™” λ° λ³µνΈν™”ν•  μ μλ‹¤
- ν¬μ§€ μ•μ€ kμ— λ€ν•΄μ„λ„ μ…λ ¥ κ°€λ¥ν• λ¨λ“  λΈ”λ΅μ— λ€μ‘ν•λ” ν…μ΄λΈ”μ„ μ μ§€ν•κΈ° μ–΄λ µλ‹¤
    - ex. k=64λΌλ©΄, μ†΅/μμ‹ μλ” $2^{64}!$ ν¬κΈ°μ ν…μ΄λΈ”μ„ μ μ§€ν•΄μ•Ό ν•λ‹¤
    - λ¨λ“  μ…λ ¥ λΈ”λ΅κ³Ό μ¶λ ¥ λΈ”λ΅ κ°„μ μ‚¬μƒμ΄ λ―Έλ¦¬ κ²°μ •λμ–΄ μμ
- ν•΄κ²°μ±…
    - k=64λΌλ©΄, 64λΉ„νΈλ¥Ό ν†µμ§Έλ΅ μ•”νΈν™”ν•λ” κ²ƒμ΄ μ•„λ‹, 8λΉ„νΈμ”© λμ–΄μ„ μ•”νΈν™”
    - k=8μΈ ν…μ΄λΈ”μ„ 8κ° κ΄€λ¦¬ν•λ©΄ λλ―€λ΅, $8\times 2^8!$ ν¬κΈ°μ ν…μ΄λΈ”μ„ μ μ§€ν•λ©΄ λλ‹¤
    - κ°κ°μ 8λΉ„νΈ μ•”νΈλ“¤μ€ μ¤ν¬λ¨λΈ”λ¬λ¥Ό ν†µν•΄ μμ„κ°€ λ³€κ²½λκ³  μ„ κ³Όμ •μ„ nν λ°λ³µ
    - `DES(Data Encryption Standard)`, `3DES`, `AES(Advanced Encryption Standard)` λ“±μ΄ μμ
    - κ°κ°μ ν‘μ¤€λ“¤μ€ λΉ„νΈμ—΄μ„ ν‚¤λ΅ μ‚¬μ©
        - DES : `56λΉ„νΈμ ν‚¤`, `64λΉ„νΈ λΈ”λ΅`
        - AES : `128, 192, 256λΉ„νΈμ ν‚¤`, `128λΉ„νΈ λΈ”λ΅`
    - ν‚¤λ” μ•κ³ λ¦¬μ¦ λ‚΄λ¶€μ—μ„ λ―Έλ‹ ν…μ΄λΈ”μ μ‚¬μƒκ³Ό μμ—΄μ„ κ²°μ •

#### 5) μ•”νΈν™” λΈ”λ΅ μ²΄μ΄λ‹(CBC, Cipher Block Chaining)
λ‘ κ° μ΄μƒμ ν‰λ¬Έ λΈ”λ΅μ΄ λ™μΌν•λ‹¤λ©΄ μ›λ¬Έμ„ μ¶”μΈ΅ν•  μ κ°€λ¥μ„±μ΄ μƒκΈ΄λ‹¤. ν‰λ¬Έ λΈ”λ΅μ λ‚΄μ©μ΄ λ™μΌν•λ”λΌλ„ λ‹¤λ¥Έ μ•”νΈλ¬Έ λΈ”λ΅μ΄ μƒμ„±λλ„λ΅ μ„μμ„±(randomness)μ„ μ¶”κ°€ν•λ©΄ μ›λ¬Έμ„ μ¶”μΈ΅ν•κΈ° μ–΄λ µμ§€ μ•μ„κΉ?

##### μ•„μ΄λ””μ–΄
- $K_S$: ν‚¤κ°€ SμΈ λΈ”λ΅ μ•”νΈν™” μ•κ³ λ¦¬μ¦
- $r(i)$: iλ²μ§Έ λΈ”λ΅μ„ μ„ν• kλΉ„νΈ κΈΈμ΄μ μ„μμ μ
- $c(i) = K_S(m(i) \oplus r(i))$
    - ν‰λ¬Έκ³Ό μ„μ μλ¥Ό XOR μ—°μ‚°ν• ν›„, ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”
    - μ†΅μ‹ μλ” $c(1)$, $r(1)$, $c(2)$, $r(2)$, ... κ°™μ€ λ°©μ‹μΌλ΅ μ†΅μ‹ 
- κ³µκ²©μκ°€ $r(i)$μ™€ $c(i)$λ¥Ό μ•λ”λΌλ„ $K_S$μ—†μ΄λ” λ³µνΈν•΄λ‚Ό μ μ—†μ
- λ™μΌν• λ‚΄μ©μ΄λ”λΌλ„ μ„μμ μμ™€ XOR μ—°μ‚°μ„ ν–κΈ° λ•λ¬Έμ— μ„λ΅ λ‹¤λ¥Έ λΉ„νΈλ¥Ό κ°€μ§„λ‹¤
- λ¬Έμ 
    - μ†΅μ‹ μλ” μ„μ λ¬Έμμ—΄ $r(i)$λ¥Ό ν•¨κ» λ³΄λ‚΄μ•Όν•λ―€λ΅ μ „μ†΅λ‰μ΄ 2λ°°κ°€ λλ‹¤

##### ν•΄κ²°
- μ²« λ²μ§Έ λ©”μ‹μ§€μ™€ μ„μμ μ(μ΄κΈ°ν™” λ²΅ν„°, IV, Initialization Vector)λ¥Ό λ‹¨ ν•λ²λ§ μ „μ†΅
- μ΄ν›„μ—λ” `μ„μμ μλ΅ μ§μ „μ— κ³„μ‚°λ μ•”νΈν™” λΈ”λ΅μ„ λ€μ‹  μ‚¬μ©`
- κ³Όμ •
    1. μ†΅μ‹ μλ” IVλ¥Ό ν‰λ¬Έ ν•νƒλ΅ μμ‹ μμ—κ² μ†΅μ‹ 
    2. μ†΅μ‹ μλ” $c(1) = m(1) \oplus c(0)$μ„ κ³„μ‚°
    3. $c(1) = K_S(m(1) \oplus c(0))$μ„ μμ‹ μμ—κ² μ „λ‹¬
    4. $i$λ²μ§Έ λΈ”λ΅μ— λ€ν•΄ μ†΅μ‹ μλ” $c(i) = K_S(m(i) \oplus c(i-1))$μ„ κ³„μ‚°ν•μ—¬ μ•”νΈν™” λΈ”λ΅μ„ μƒμ„±
- μμ‹ μλ” μ—¬μ „ν μ›λ λ©”μ‹μ§€λ¥Ό λ³µκµ¬ κ°€λ¥
- ν‰λ¬Έμ΄ λ™μΌν•λ”λΌλ„ μ„λ΅ λ‹¤λ¥Έ μ„μ λ¬Έμμ—΄λ΅ μΈν•΄ μ„λ΅ λ‹¤λ¥Έ μ•”νΈλ¬Έμ΄ μƒμ„±
- μ†΅μ‹ μλ” IVλ¥Ό μ•”νΈν™”ν•μ§€ μ•λ”λΌλ„ κ³µκ²©μλ” $K_S$λ¥Ό λ¨λ¥΄λ―€λ΅ μ•”νΈλ¬Έ λΈ”λ΅μ„ ν•΄λ…ν•  μ μ—†μ
- μ†΅μ‹ μλ” IV ν•λ‚λ§μ„ μ¶”κ°€ν•λ©΄λλ―€λ΅ λ€μ—­ν­ μ¦κ°€λ‰μ΄ λ―Έλ―Έν•¨

### 2.2 κ³µκ°ν‚¤ μ•”νΈν™”
λ‘ ν†µμ‹  κ΄€κ³„μκ°€ μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό ν•κΈ° μ„ν•΄μ„λ” κ³µν†µμ λΉ„λ°€ν‚¤λ¥Ό ν•„μ”λ΅ ν•λ‹¤. μ΄λ¥Ό μ„ν•΄μ„λ” μ†΅μ‹ μμ™€ μμ‹ μλ” `μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό μ„ν•΄ ν•„μ”ν• ν‚¤`λ¥Ό κ³µμ ν•΄μ•Ό ν•λ‹¤.

- κ³µκ°ν‚¤ μ•”νΈν™” λ°©μ‹μ€ ν•λ‚μ λΉ„λ°€ν‚¤λ¥Ό μ‚¬μ©ν•μ§€ μ•κ³  `λ©”μ‹μ§€ μμ‹ μ`κ°€ 2κ°μ ν‚¤λ¥Ό κ°€μ§„λ‹¤. 
- κ³µκ°ν‚¤(public key) : λ¨λ“  μ‚¬λμ—κ² μ•λ ¤μ§„ ν‚¤, $K^+_B$
- κ°μΈν‚¤(private key, secret key) : μμ‹ μλ§μ΄ κ°€μ§„ ν‚¤, $K^-_B$
- κ³Όμ •
    1. μ†΅μ‹ μλ” μμ‹ μμ κ³µκ°ν‚¤λ¥Ό κ°€μ Έμ¨λ‹¤
    2. (λ¨λ“  μ‚¬λμ΄ μ•κ³  μλ”) μμ‹ μμ κ³µκ°ν‚¤μ™€ μ΄λ―Έ μ•λ ¤μ§„ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν•΄ λ©”μ‹μ§€ $m$μ„ μ•”νΈν™”ν•λ‹¤, $K^+_B(m)$
    3. μμ‹ μλ” μ•”νΈν™”λ λ©”μ‹μ§€($K^+_B(m)$)μ™€ κ°μΈν‚¤, μ΄λ―Έ μ•λ ¤μ§„ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν•΄ λ³µνΈν™”ν•λ‹¤, $K^-_B(K^+_B(m))=m$
- νΉμ§•
    - $K^-_B(K^+_B(m))=m$ = $K^+_B(K^-_B(m))=m$
- λ¬Έμ 
    1. κ³µκ²©μλ” μ΄λ―Έ μ•λ ¤μ§„ μ•κ³ λ¦¬μ¦κ³Ό κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄ μμ‹ μ λ©”μ‹μ§€λ¥Ό μ•”νΈν™”ν•λ” `μ„ νƒ ν‰λ¬Έ κ³µκ²©`μ„ ν•  μ μμ
    2. μ•”νΈν‚¤λ” μ΄λ―Έ κ³µκ°λμ–΄ μκΈ° λ•λ¬Έμ— λ„κµ¬λ“  μ†΅μ‹ μλ¥Ό μ‚¬μΉ­ν•΄ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Ό μ μμ

#### 1) RSA(Rivest, Adi Shamir, Leonard Adleman) μ•κ³ λ¦¬μ¦
- κ³µκ°ν‚¤ μ•”νΈν™”μ™€ κ±°μ λ™μμ–΄μ²λΌ μ·¨κΈ‰λ¨
- modulo-n μ—°μ‚°μ΄ λ§μ΄ μ‚¬μ©λ¨

$$
[(a\ mod\ n)\ +\ (b\ mod\ n)\ =\ (a\ +\ b)\ mod\ n] \\
[(a\ mod\ n)\ -\ (b\ mod\ n)\ =\ (a\ -\ b)\ mod\ n] \\
[(a\ mod\ n)\ \cdot\ (b\ mod\ n)\ =\ (a\ \cdot\ b)\ mod\ n] \\
(a\ mod\ n)^d\ mod\ n\ =\ a^d\ mod\ n
$$

##### κ³µκ°ν‚¤ & κ°μΈν‚¤μ μƒμ„±
1. λ‘ κ°μ ν° μ†μ pμ™€ qλ¥Ό μ„ νƒν•λ‹¤
    - κ°’μ΄ μ»¤μ§μλ΅ RSAλ¥Ό κΉ¨κΈ° μ–΄λ µμ§€λ§, μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό μν–‰ν•λ” λ° κ±Έλ¦¬λ” μ‹κ°„μ΄ μ¤λ κ±Έλ¦Ό
2. $n = pq,\ z = (p-1)(q-1)$ μ‹μ„ κ³„μ‚°
3. zμ™€ μ„λ΅μ†μΈ μ eλ¥Ό μ„ νƒ($e<n$)
4. $ed\ mod\ z\ =\ 1$μΈ μ $d$λ¥Ό μ°Ύλ”λ‹¤
- λ¨λ“  μ‚¬λμ΄ μ‚¬μ©ν•  μ μλ” λ°¥μ κ³µκ°ν‚¤ $K^+_B$λ” μ«μ μ $(n, e)$κ°€ λλ‹¤
- μμ‹ μμ κ°μΈν‚¤ $K^-_B$λ” μ«μ μ $(n, d)$κ°€ λλ‹¤
- κ³Όμ •
    1. μ†΅μ‹ μκ°€ μ •μ m (m < n)μΈ λΉ„νΈλ¥Ό μ „μ†΅ν•λ ¤ ν•λ‹¤
        - μ†΅μ‹ μλ” $m^e$λ¥Ό μν–‰ν•κ³ , nμΌλ΅ λ‚λ„μ—μ„ λ•μ λ‚λ¨Έμ§€λ¥Ό κ³„μ‚°ν•λ‹¤
        - μ†΅μ‹ μκ°€ λ³΄λ‚΄λ” ν‰λ¬Έ λ©”μ‹μ§€ mμ μ•”νΈκ°’ cλ” $c = m^e\cdot mod\ n$
    2. μ†΅μ‹ μκ°€ μμ‹ μμ—κ² μ•”νΈκ°’ cλ¥Ό μ „λ‹¬ν•λ‹¤
    3. μμ‹ μλ” κ°μΈν‚¤λ¥Ό μ΄μ©ν•΄ λ³µνΈν™”λ¥Ό μν–‰ν•λ‹¤
        - $m = c^d \cdot mod\ n$
- μμ‹
    1. p=5, q=7μ„ μ„ νƒν•λ‹¤
    2. $n=5\times 7=35,\quad z=(5-1)\times (7-1)=24$
    3. 24μ™€ μ„λ΅μ†μΈ μ„μμ μ $e=5$λ¥Ό μ„ νƒ
    4. $5\times 29\ mod\ 24 = 145 \mod 24=1$λ΅, $d=29$λ¥Ό μ‚¬μ©
        - κ³µκ°ν‚¤: $K^+_B=(35,\ 5)$
        - κ°μΈν‚¤: $K^-_B=(35,\ 29)$
- λ™μ‘ μ›λ¦¬
    1. λ©”μ‹μ§€ mμ€ modulo-n μ—°μ‚°μ„ μ‚¬μ©ν•΄ eλ¥Ό μ κ³±ν•¨
        - $c = m^e \times mod\ n$
    2. λ³µνΈν™”λ” μ΄ κ°’μ— λ‹¤μ‹ modulo-n μ—°μ‚°μ„ μ‚¬μ©ν•΄ dλ¥Ό μ κ³±ν•¨
        - $(m^e \times mod\ n)^d mod\ n=m^{ed}\ mod\ n$
        - $m^{ed}\ mod\ n = m^{ed\ mod\ z}\ mod\ n = m^1\ mod\ n=m\ mod\ n = m$

```
Diffie-Hellman μ•κ³ λ¦¬μ¦

* μ„μ κΈΈμ΄μ λ©”μ‹μ§€λ¥Ό μ•”νΈν™”ν•  μ μ—†λ‹¤λ” μ μ—μ„ RSAλ§νΌ μ μ©ν•μ§€λ” μ•μ§€λ§ λ€μΉ­ μ„Έμ…ν‚¤(ν•μ΄λΈλ¦¬λ“ μ•”νΈ λ°©μ‹)λ¥Ό μƒμ„±ν•  λ• μ‚¬μ© κ°€λ¥
```

#### 2) μ„Έμ…ν‚¤ (ν•μ΄λΈλ¦¬λ“ μ•”νΈ λ°©μ‹)
- κ³µκ°ν‚¤ λ°©μ‹μΈ RSAλ” μ§€μ μ—°μ‚°μ μ‹κ°„μ΄ λ§μ΄ ν•„μ”
- λ€μΉ­ν‚¤ λ°©μ‹μΈ μ•”νΈν™”/λ³µνΈν™” μ†λ„κ°€ 100λ°°μ—μ„ μµλ€ 10,000λ°° λ” λΉ λ¥΄λ‹¤
- `μ†΅μ‹ μ`λ” μ„Έμ…ν‚¤ $K_S$λ¥Ό μ„ νƒν•λ‹¤
    - $K_S$λ” μ†λ„κ°€ λΉ λ¥Έ λ€μΉ­ν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤
- λ€μΉ­ν‚¤λ¥Ό μƒλ€λ°©μ—κ² μ•λ ¤μ£ΌκΈ° μ„ν•΄ `μμ‹ μμ κ³µκ°ν‚¤`λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”ν•λ‹¤
    - $c = (K_S)^e\ mod\ n$
- μμ‹ μλ” RSAλ΅ μ•”νΈν™”λ cλ¥Ό λ°›κ³ , λ³µνΈν™”λ¥Ό ν†µν•΄ `μ„Έμ…ν‚¤` $K_S$λ¥Ό μ–»λ”λ‹¤
- μ΄ν›„λ΅λ” `μ„Έμ…ν‚¤(λ€μΉ­ν‚¤)`λ¥Ό μ΄μ©ν•΄ ν†µμ‹ μ„ μ£Όκ³  λ°›λ”λ‹¤

## π“ 3. μ „μμ„λ… : λ©”μ‹μ§€ λ¬΄κ²°μ„±(message intigrity)
λ©”μ‹μ§€ λ¬΄κ²°μ„±(λ©”μ‹μ§€ μΈμ¦), μ „μμ„λ…(digital signature), μΆ…λ‹¨μ  μΈμ¦(end-point authentication)μ— λ€ν•΄μ„ κ³µλ¶€

##### λ¬Έμ μ μ •μ
μμ‹ μλ” λ°›μ€ λ©”μ‹μ§€κ°€ μ†΅μ‹ μκ°€ λ³΄λ‚Έ κ²ƒμ΄λΌ λ―Ώκ³  μλ‹¤. λ©”μ‹μ§€λ¥Ό μΈμ¦ν•κΈ° μ„ν•΄ μμ‹ μλ” λ‹¤μμ„ ν™•μΈν•΄μ•Ό ν•λ‹¤.
1. λ©”μ‹μ§€λ” κ³µκ²©μκ°€ μ•„λ‹ μ†΅μ‹ μκ°€ λ³΄λ‚Έ κ²ƒμ΄ λ§λ‹¤
2. λ©”μ‹μ§€λ” λ³€μ΅°λμ§€ μ•μ•λ‹¤

### 3.1 μ•”νΈν™” ν•΄μ‹ ν•¨μ
- ν•΄μ‹ ν•¨μ: μ…λ ¥ mμ„ λ°›μ•„μ„ κ³ μ •λ ν¬κΈ° λ¬Έμμ—΄μΈ ν•΄μ‹ $H(m)$μ„ κ³„μ‚°
    - $H(x) = H(y)$κ°€ λλ” μ„λ΅ λ‹¤λ¥Έ λ‘ λ©”μ‹μ§€ $x$μ™€ $y$λ¥Ό μ°Ύλ” κ²ƒμ€ λ¶κ°€λ¥ν•λ‹¤γ…“
- λ³΄μ•μ„ μ„ν•΄μ„λ” μ²΄ν¬μ„¬λ³΄λ‹¤ λ”μ± κ°•λ ¥ν• ν•΄μ‹ ν•¨μκ°€ ν•„μ”
    - μ²΄ν¬μ„¬μ€ λ™μΌν• λ¬Έμμ—΄μ΄μ§€λ§ μμ„κ°€ λ‹¤λ¥Έ κ²½μ° λ™μΌν• κ°’μ„ κ°€μ§ μ μμ

### 3.2 λ©”μ‹μ§€ μΈμ¦ μ½”λ“(MAC, Message Authentication Code)
- λ©”μ‹μ§€ λ¬΄κ²°μ„±μ„ μ„ν•΄μ„λ” μ•”νΈν™” ν•΄μ‹ ν•¨μμ μ‚¬μ© μ™Έμ—λ„ μ†΅μ‹ μμ™€ μμ‹ μμ λ€μΉ­ν‚¤λ¥Ό κ³µμ ν•  ν•„μ”κ°€ μμ
- MACμ€ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ ν•„μ”λ΅ ν•μ§€ μ•μ
- λ€μ²΄λ΅ ν†µμ‹  κ°μ²΄λ“¤μ€ λ¬΄κ²°μ„±μ„ μ‹ κ²½μ“°μ§€ κΈ°λ°€μ„±μ„ κ³ λ ¤ν•μ§€ μ•μ
    - λ„κµ°κ°€ λ©”μ‹μ§€λ¥Ό λ³Ό μ μλ”λΌλ„, λ©”μ‹μ§€μ λ‚΄μ©μ„ μμ •ν•  μλ” μ—†μ
- MACμ€ λ³µμ΅ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ ν¬ν•¨μ‹ν‚¤μ§€ μ•κ³ λ„ μ„λ΅μ—κ² λ³΄λ‚΄λ” λ©”μ‹μ§€λ¥Ό μΈμ¦ν•  μ μμ
- κ°€μ¥ λ§μ΄ μ‚¬μ©λλ” ν‘μ¤€μ€ HMAC

### 3.3 μ „μμ„λ…(Digital Signature)
- μ†΅μ‹ μκ°€ λ©”μ‹μ§€μ— μ„λ…ν•  λ• μμ‹ μλ” κ³ μ ν• λ¬΄μ–Έκ°€λ¥Ό λ©”μ‹μ§€μ— ν¬ν•¨μ‹μΌμ•Ό ν•¨
- MACμ€ μμ‹ μ λν• λ™μΌν• μ„λ…μ„ λ§λ“¤ μ μκΈ° λ•λ¬Έμ— MACμ€ μ „μμ„λ…μΌλ΅ μ ν•©ν•μ§€ μ•μ
- κ³µκ°ν‚¤ μ•”νΈν™” κΈ°μ¨γ„Ήμ€ μ „μμ„λ…μ κµ¬ν„μ— μ ν•©
- μ „μμ„λ…μ—μ„λ” λ©”μ‹μ§€λ¥Ό κ°μΈν‚¤(λΉ„λ°€ν‚¤)κ°€ μ•„λ‹ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”($K^-_B(m)$)
    - μ „μμ„λ…μ„ λ³΄λ‚΄λ” μ…μ¥μ—μ„λ” κΈ°λ°€μ„±λ³΄λ‹¤λ” μ…μ¦μ΄ κ°€λ¥ν•κ³  μ„μ΅°ν•  μ μ—†κ² ν•λ” κ²ƒμ΄ λ©μ 
- μ „μμ„λ…μ—μ„λ” λ©”μ‹μ§€(μ„λ…)λ¥Ό λ§λ“¤ λ• $K^-_B$λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”
- κ°μΈν‚¤ $K^-_B$λ¥Ό μ•κ³  μλ” μ‚¬λμ€ μ†΅μ‹ μλΏμ΄κΈ° λ•λ¬Έμ— μ‚¬ν›„ λ¶€μ •μ„ ν•  μ μ—†μ
- μ¤‘κ°„μ—μ„ κ³µκ²©μκ°€ λ©”μ‹μ§€μ λ‚΄μ©μ„ λ³€κ²½ν•λ”λΌλ„ λ©”μ‹μ§€μ λ‚΄μ©μ„ λ³€κ²½ν•λ©΄ μ„λ…μ΄ λ³€κ²½λκΈ° λ•λ¬Έμ— λ” μ΄μƒ μ ν¨ν•μ§€ μ•μ
- μ „μμ„λ…μ€ λ³€μ΅°, λ©”μ‹μ§€ λ¬΄κ²°μ„±μ„ μ κ³µ
- λ¬Έμ μ 
    - μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό μ„ν• μ—°μ‚°μ΄ λ§λ‹¤
- ν•΄κ²°μ±…
    - ν•΄μ‹ν•¨μλ¥Ό μ΄μ©ν•΄ λ¨Όμ € ν•΄μ‹κ°’μ„ κµ¬ν• ν›„, μ΄ κ°’κ³Ό μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ©΄ μ—°μ‚°λ‰μ„ μ¤„μΌ μ μμ

```
MAC(Message Authentication Code)
* κ³µκ°ν‚¤ μ•”νΈν™”λ‚ λ€μΉ­ν‚¤ μ•”νΈν™”κ°€ μ‚¬μ©λμ§€ μ•μ

μ „μμ„λ…(Digital Signature)
* λ©”μ‹μ§€μ ν•΄μ‹κ°’μ„ μ–»κ³  κ°μΈν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”
```

## π“ 4. μΆ…λ‹¨μ  μΈμ¦(End-point Authentication)
- μΆ…λ‹¨μ  μΈμ¦(End-point Authentication)
    - ν•λ‚μ ν†µμ‹  κ°μ²΄κ°€ μμ‹ μ μ‹ μ›μ„ λ„¤νΈμ›ν¬ μƒμ—μ„ μ¦λ…ν•λ” μ‘μ—…
- μΈμ¦ ν”„λ΅ν† μ½(Authenticaiton Protocol)μ€ κµν™λ λ©”μ‹μ§€μ™€ λ°μ΄ν„°λ§μ„ κΈ°λ°μΌλ΅ μν–‰λμ–΄μ•Ό ν•λ‹¤
- μΈμ¦λ ν›„μ— μ†΅μ‹ μμ™€ μμ‹ μλ” μ‹¤μ  μ‘μ—…μ„ μν–‰ν•  μ μμ

### 4.1 μΈμ¦ν”„λ΅ν† μ½ ap1.0
- μ†΅μ‹ μ μ…μ¥μ—μ„ μμ‹ μμ—κ² μμ‹ μ΄ μ •λ‹Ήν• μμ‹ μλΌκ³  μ „λ‹¬
- ν•μ§€λ§ μ΄λ° λ©”μ‹μ§€λ” μ•„λ¬΄λ‚ λ³΄λ‚Ό μ μλ‹¤λ” λ¬Έμ κ°€ μμ

### 4.2 μΈμ¦ ν”„λ΅ν† μ½ ap2.0
- μμ‹ μλ” μ†΅μ‹ μμ μ¶λ°μ§€ μ£Όμ†λ¥Ό ν†µν•΄ μ†΅μ‹ μλ¥Ό μΈμ¦ν•  μ μμ
- κ³µκ²©μκ°€ μ¶λ°μ§€ μ£Όμ†λ¥Ό μ„μλ΅ λ³€κ²½ν•μ—¬ μμ‹ μμ—κ² λ©”μ‹μ§€λ¥Ό μ „λ‹¬ν•  μ μμ
    - IP μ¤ν‘Έν•‘
- λΌμ°ν„°κ°€ μ„μλ΅ λ³€κ²½λ μ†΅μ‹ μμ μ£Όμ†λ¥Ό κ²€μ¦ν•  μλ„ μμ§€λ§, μ‹¤μ§μ μΌλ΅ λΌμ°ν„°κ°€ μ£Όμ†λ¥Ό κ²€μ¦ν•μ§€ μ•κ³  κ°•μ ν•  μ μ—†μ

### 4.3 μΈμ¦ ν”„λ΅ν† μ½ ap3.0
- μΈμ¦μ„ μ„ν• λΉ„λ°€λ²νΈλ¥Ό μ‚¬μ©
- λΉ„λ°€λ²νΈλ” μΈμ¦μμ™€ μΈμ¦ λ°›λ” μ‚¬λ κ°„μ— κ³µμ λ λΉ„λ°€
- λ„κµ°κ°€ ν†µμ‹ μ„ λ„μ²­ν•λ©΄ λΉ„λ°€λ²νΈλ¥Ό μ•μ•„λ‚Ό μ μμ

### 4.4 μΈμ¦ ν”„λ΅ν† μ½ ap3.1
- ap3.0μ λΉ„λ°€λ²νΈλ¥Ό μ•”νΈν™”
- κ³µκ²©μ μ…μ¥μ—μ„λ” λΉ„λ°€λ²νΈ μμ²΄λ¥Ό μ•μ•„λ‚΄μ§€ λ»ν•λ”λΌλ„ μ•”νΈν™”λ μ•”νΈ μμ²΄λ¥Ό λ„μ²­ν•μ—¬ μμ‹ μμ—κ² λ©”μ‹μ§€λ¥Ό λ³΄λ‚Ό μ μμ

### 4.5 μΈμ¦ ν”„λ΅ν† μ½ 4.0
- TCP μ„λ²„κ°€ μμ‹ λ°›μ€ SYN μ„Έκ·Έλ¨ΌνΈκ°€ μ΄μ „ μ—°κ²° SYN μ„Έκ·Έλ¨ΌνΈμ λ³µμ‚¬λ³Έμ΄λΌλ©΄ μ—°κ²°μ„ μλ½ν•μ§€ μ•μ
- μ„λ²„λ” μ¤λ«λ™μ• μ‚¬μ©λμ§€ μ•μ€ μ΄κΈ° μμ„λ²νΈλ¥Ό μ„ νƒν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ—κ² λ²νΈλ¥Ό λ³΄λƒ„
- ν΄λΌμ΄μ–ΈνΈλ” μ΄ λ²νΈλ¥Ό λ‹΄μ€ ACK μ„Έκ·Έλ¨ΌνΈ μ‘λ‹µμ„ λ€κΈ°

#### 1) λ„μ¤(nonce)
- λ„μ¤λ” ν”„λ΅ν† μ½μ΄ ν‰μƒμ— ν• λ²λ§ μ‚¬μ©ν•λ” μ«μ
- ν”„λ΅ν† μ½μ΄ ν• λ² μ–΄λ–¤ λ„μ¤λ¥Ό μ‚¬μ©ν•λ©΄ μ΄ μ«μλ¥Ό μ λ€ λ‹¤μ‹ μ‚¬μ©ν•μ§€ μ•μ
- κ³Όμ •
    1. μ†΅μ‹ μλ” "λ‚λ” μ†΅μ‹ μλ‹¤"λ¥Ό μμ‹ μμ—κ² μ†΅μ‹ 
    2. μμ‹ μλ” λ„μ¤ $R$μ„ μ„ νƒν•κ³ , μ†΅μ‹ μμ—κ² μ‘λ‹µ
    3. μ†΅μ‹ μλ” λ€μΉ­ν‚¤μΈ $K_{A-B}$λ¥Ό μ‚¬μ©ν•΄ λ„μ¤λ¥Ό μ•”νΈν™”
    4. μ•”νΈν™”λ λ„μ¤ $K_{A-B}$λ” μμ‹ μμ—κ² λ³΄λ‚΄μ§
    5. μμ‹ μλ” λ°›μ€ λ©”μ‹μ§€λ¥Ό λ³µνΈν™”
    6. λ³µνΈν™”λ λ„μ¤κ°€ μ†΅μ‹ μμ—κ² λ³΄λ‚Έ κ²ƒκ³Ό κ°™λ‹¤λ©΄ μ†΅μ‹ μλ¥Ό μΈμ¦

## π“ 5. μ „μμ°νΈμ λ³΄μ•
- μΈν„°λ„· ν”„λ΅ν† μ½ μ¤νƒ μ„μ½ λ„¤ κ° κ³„μΈµμ μ–΄λ κ³³μ΄λ“  λ³΄μ• μ„λΉ„μ¤λ¥Ό μ κ³µν•λ” κ²ƒμ΄ κ°€λ¥
- ν•λ‚μ κ³„μΈµμ—μ„ λ³΄μ• κΈ°λ¥μ„ μ κ³µν•λ‹¤λ©΄?
    1. ν•μ„ κ³„μΈµμ—μ„ λ³΄μ•μ„ μ κ³µν•λ”λΌλ„ μ— κ³„μΈµμ μ…μ¥μ—μ„λ” μΈμ¦ κ³Όμ •μ΄ ν•„μ”ν•  μ μμ
        - ex. μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµμ λ΅κ·ΈμΈ
    2. ν”„λ΅ν† μ½ μ¤νƒμ μƒμ„ κ³„μΈµμ—μ„ λ³΄μ• μ„λΉ„μ¤λ¥Ό ν¬ν•¨ν• μƒλ΅μ΄ μΈν„°λ„· μ„λΉ„μ¤λ¥Ό κµ¬ν„ν•λ” μΌμ΄ μ‰¬μ›μ§
        - ν•μ„ κ³„μΈµ λ³΄μ• ν”„λ΅ν† μ½μ— μμ΅΄ν•μ§€ μ•κ³  μƒμ„ κ³„μΈµμ—μ„ λ…λ¦½μ μΌλ΅ μμ²΄μ μΈ λ³΄μ• κΈ°λ¥μ„ μ¶”κ°€ν•  μ μμ

μ „μμ°νΈ μ‹μ¤ν…μ—μ„ μ–΄λ–¤ λ³΄μ• νΉμ„±μ΄ ν•„μ”ν• κΉ?
1. κΈ°λ°€μ„± : μΈμ¦λ μ‚¬μ©μλ§ λ©”μ‹μ§€λ¥Ό μ½μ„ μ μλ‹¤
2. μ†΅μ‹ μ μΈμ¦ : μμ‹ μλ” μ†΅μ‹ μκ°€ λ³΄λ‚Έ λ©”μ‹μ§€λΌ ν™•μ‹ ν•  μ μλ‹¤
3. λ©”μ‹μ§€ λ¬΄κ²°μ„± : λ©”μ‹μ§€κ°€ μ „μ†΅λλ” λ™μ• λ³€μ΅°λμ§€ μ•λ”λ‹¤
4. μμ‹ μ μΈμ¦ : μΈμ¦λ μ‚¬μ©μλ§μ΄ μ†΅μ‹ λ λ©”μ‹μ§€λ¥Ό μ½μ„ μ μλ‹¤

### 5.1 λ³΄μ• μ „μμ°νΈ
#### 1) κΈ°λ°€μ„±λ§μ„ μƒκ°ν•λ” κ²½μ°
- λ€μΉ­ν‚¤ κΈ°μ (DES, AES) : μμ‹ μκ°€ λ³µνΈν™”
- μ†΅μ‹ μμ™€ μμ‹ μλ§μ΄ μ• μ μλ” λ€μΉ­ν‚¤λ¥Ό λ°°ν¬ν•΄μ•Ό ν•λ” κ·Όλ³Έμ μΈ μ–΄λ ¤μ›€μ΄ μμ -> κ³µκ°ν‚¤ λ°©μ‹μ„ ν†µν•΄ κµν™ κ°€λ¥
- κ³µκ°ν‚¤ κΈ°μ (RSA) : κΈΈμ΄κ°€ κΈ΄ λ©”μ‹μ§€μ— λ€ν•΄ λΉ„ν¨μ¨μ μ΄λΌλ” λ¬Έμ κ°€ μ΅΄μ¬
- ν•μ΄λΈλ¦¬λ“ μ•”νΈν™”(μ„Έμ…ν‚¤) : λΉ„λ€μΉ­ν‚¤λ¥Ό μ΄μ©ν•΄ λ€μΉ­ν‚¤λ¥Ό κµν™ν•κ³  μ‹¤μ§μ μΌλ΅ λ€μΉ­ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό μ§„ν–‰

#### 2) μΈμ¦κ³Ό λ¬΄κ²°μ„±μ—λ§ κ΄€μ‹¬μ΄ μλ” κ²½μ°
- μ „μμ„λ…κ³Ό λ©”μ‹μ§€ μ”μ•½λ¬Έ(ν•΄μ‹)λ¥Ό μ΄μ©
- μ†΅μ‹ μλ” ν•΄μ‹ κ³„μ‚°λ ν›„ ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”λ $K^-_A(H(m))$λ¥Ό μ „μ†΅
- κ³Όμ •
    1. μ†΅μ‹ μλ” λ©”μ‹μ§€μ— ν•΄μ‹λ¥Ό μ μ© -> $H(m)$
    2. ν•΄μ‹ ν•¨μ κ²°κ³Όμ™€ κ°μΈν‚¤ $K^-_A$λ΅ μ•”νΈν™” μν–‰ -> $K^-_A(H(m))$
    3. `λ©”μ‹μ§€μ™€ μ „μμ„λ…`μ„ κ²°ν•©ν•΄ ν¨ν‚·μ„ μƒμ„±
    4. ν¨ν‚·μ„ μμ‹ μμ μ „μμ°νΈ μ£Όμ†λ΅ μ†΅μ‹ 
    5. μμ‹ μλ” λ°›μ€ ν¨ν‚·μ— $K^+_A$μ„ μ μ©
    6. λ©”μ‹μ§€μ— ν•΄μ‹ ν•¨μ $H$λ¥Ό μ μ©ν•κ³  μ†΅μ‹ μκ°€ λ³΄λ‚Έ μ „μμ„λ…κ³Ό λΉ„κµ
    7. μμ‹ μλ” μ†΅μ‹ μκ°€ λ³΄λ‚Έ λ©”μ‹μ§€κ°€ λ³€μ΅°λμ§€ μ•μμ„ ν™•μ‹ 

### 5.2 PGP(Pretty Good Privacy)
- PGPλ” μ „μμ°νΈ μ•”νΈν™” κΈ°λ²•μ μμ‹
- λ²„μ „μ— λ”°λΌ PGPλ” MD5λ‚ SHAλ¥Ό λ©”μ‹μ§€μ— μ‚¬μ©
- PGPκ°€ μ„¤μΉλλ©΄ μ†ν”„νΈμ›¨μ–΄λ” μ‚¬μ©μλ¥Ό μ„ν• κ³µκ°ν‚¤ μμ„ μƒμ„±
- PGPλ” `μ „μμ„λ…`, `μ•”νΈν™”`, λλ” `μ „μμ„λ… + μ•”νΈν™”` λ°©μ‹μ„ μ κ³µ

## π“ 6. TCP μ—°κ²°μ λ³΄μ• : TLS
- μ΄ μ μ—μ„λ” TCPμ— μ–΄λ–»κ² κΈ°λ°€μ„±, λ°μ΄ν„° λ¬΄κ²°μ„±, μΆ…λ‹¨μ  μΈμ¦ λ“±μ λ³΄μ• μ„λΉ„μ¤λ¥Ό μ μ©ν•  μ μλ”μ§€μ— λ€ν•΄ κ³µλ¶€ν•λ‹¤
- μ΄λ ‡κ² ν–¥μƒλ TCPλ” ν”ν TLS(Transport Layer Security)λΌκ³  λ¶€λ¥Έλ‹¤
- httpsλ¥Ό μ΄μ©ν•λ‹¤λ©΄ TLSλ¥Ό μ΄μ©ν•λ” κ²ƒ
- TLSκ°€ ν•„μ”ν• μμ‹ : μ‚¬μ©μκ°€ λ¬Όν’μ„ κµ¬λ§¤
    - κΈ°λ°€μ„±μ΄ μ κ³µλμ§€ μ•μ : κ³µκ²©μκ°€ μ£Όλ¬Έ λ‚΄μ©μ„ κ°€λ΅μ±„μ„ μ‹ μ© μΉ΄λ“ μ •λ³΄λ¥Ό μ–»μ„ μ μμ. κ³µκ²©μλ” μ£Όλ¬Έμμ λμΌλ΅ κµ¬λ§¤ν•  μ μμ
    - λ¬΄κ²°μ„±μ΄ μ—†μ : κ³µκ²©μλ” μ£Όλ¬Έμμ μ£Όλ¬Έμ„ μμ •ν•΄μ„ μ£Όλ¬Έμμ μμ‚¬μ™€ κ΄€κ³„μ—†μ΄ λ¬Όν’μ„ κµ¬λ§¤ν•  μ μμ
    - μ„λ²„ μΈμ¦μ΄ μ κ³µλμ§€ μ•μ : κ³µκ²©μλ” μ„μμ μ‚¬μ΄νΈλ¥Ό λ§λ“¤μ–΄ μ£Όλ¬Έμμ μ •λ³΄λ¥Ό νλ“ν•  μ μμ
- TLSλ” TCPλ¥Ό ν–¥μƒν•¨μΌλ΅μ¨ μ΄λ¬ν• λ¬Έμ λ¥Ό ν•΄κ²°
- TLSλ” http μ™Έμ—λ„ TCP μƒμ—μ„ μΌμ–΄λ‚λ” μ–΄λ– ν• μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„λ„ μ‚¬μ©λ  μ μμ
- μ• ν”λ¦¬μΌ€μ΄μ…μ€ TLSλ¥Ό μ„ν•΄ SSL ν΄λμ¤/λΌμ΄λΈλ¬λ¦¬λ¥Ό μ§€μ›

### 6.1 TLS κ°μ”
- TLSμ ν•„μ”μ„±μ„ μ„ν•΄ λ‹¨μν™”λ `almost-TLS` λ²„μ „μ„ μ„¤λ…
-  almost-TLSλ” `handshake`, `ν‚¤ μ λ„(key derivation)`, `λ°μ΄ν„° μ „μ†΅(data transfer)`, μ„Έ λ‹¨κ³„λ΅ κµ¬μ„±

<br>

κ°€μ • : ν΄λΌμ΄μ–ΈνΈλ” κ°μΈν‚¤/κ³µμ©ν‚¤ μμ„ κ°€μ§€λ©°, μ‹ μ›μ„ κ³µκ°ν‚¤μ™€ κ΄€λ ¨ν•μ—¬ μΈμ¦λ°›μ

#### 1) handshake
1. ν΄λΌμ΄μ–ΈνΈλ” TCP μ—°κ²°μ„ μ„¤μ •
2. μμ‹ μ΄ μ§„μ§ ν΄λΌμ΄μ–ΈνΈμΈμ§€ ν™•μΈ
3. μ„λ²„μΈ΅μ€ TLS μ„Έμ…μ— ν•„μ”ν• λ¨λ“  λ€μΉ­ν‚¤λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ μ£Ό λΉ„λ°€ν‚¤(master secret key)λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅
4. TCP μ—°κ²°μ΄ μ„±λ¦½λλ©΄ ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—κ² `hello λ©”μ‹μ§€`λ¥Ό λ³΄λƒ„
5. ν΄λΌμ΄μ–ΈνΈλ” ν΄λΌμ΄μ–ΈνΈμ `κ³µκ°ν‚¤λ¥Ό λ‹΄μ€ μΈμ¦μ„`λ΅ μ‘λ‹µ
6. μΈμ¦μ„λ” CAμ— μν•΄ μΈμ¦λ°›κΈ° λ•λ¬Έμ—, μ„λ²„λ” μΈμ¦μ„ λ‚΄μ κ³µκ°ν‚¤κ°€ ν΄λΌμ΄μ–ΈνΈμ κ²ƒμ„μ„ λ―Ώμ„ μ μμ
7. μ„λ²„λ” MS(Master Secret)λ¥Ό μƒμ„±ν•κ³ , μ΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ κ³µκ°ν‚¤λ΅ μ•”νΈν™” -> EMS(Encrpyted Master Secret)λ¥Ό μƒμ„±
8. EMSλ” ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅λκ³ , ν΄λΌμ΄μ–ΈνΈλ” μμ‹ μ κ°μΈν‚¤λ¥Ό μ΄μ©ν•΄ EMSλ¥Ό λ³µνΈν™”, MSλ¥Ό νλ“ν•λ‹¤
9. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ TLS μ„Έμ…μ MSλ¥Ό μ•κ² λλ‹¤

#### 2) ν‚¤ μ λ„ (key derivation)
1. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ κ³µμ ν• MSλ” μ΄ν›„μ λ¨λ“  μ•”νΈν™”μ™€ λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ‚¬λ¥Ό μ„ν• λ€μΉ­ μ„Έμ…ν‚¤(λ€μΉ­ν‚¤)λ΅ μ‚¬μ©
    - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μΌλ°μ μΌλ΅ λ‹¤λ¥Έ μ•”νΈν™” ν‚¤λ¥Ό μ‚¬μ©ν•κ³ , μ•”νΈν™”μ™€ λ¬΄κ²°μ„± κ²€μ‚¬μ—λ„ μ„λ΅ λ‹¤λ¥Έ ν‚¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ•μ „
        - $E_B$ : μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λ‚΄λ” λ°μ΄ν„°μ— λ€ν• μ„Έμ… μ•”νΈν‚¤
        - $M_B$ : μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λ‚΄λ” λ°μ΄ν„°μ— λ€ν• μ„Έμ… HMAC ν‚¤
        - $E_A$ : ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² λ³΄λ‚΄λ” λ°μ΄ν„°μ— λ€ν• μ„Έμ… μ•”νΈν‚¤
        - $M_A$ : ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² λ³΄λ‚΄λ” λ°μ΄ν„°μ— λ€ν• μ„Έμ… HMAC ν‚¤

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” MSλ΅λ¶€ν„° κ°μ 4κ°μ ν‚¤λ¥Ό μƒμ„±ν•λ‹¤. μ΄κ²ƒμ€ λ‹¨μν MSλ¥Ό 4κ°μ ν‚¤λ΅ μΌκ°λ©΄ λλ‹¤. ν‚¤ μ λ„ λ‹¨κ³„μ λ§μ§€λ§‰μ— μ΄λ¥΄λ©΄, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” 4κ°μ ν‚¤λ¥Ό κ°–κ² λλ‹¤.
- 2κ°μ μ•”νΈν™” ν‚¤λ” λ°μ΄ν„° μ•”νΈν™”μ— μ‚¬μ©
- 2κ°μ HMACν‚¤λ” λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ‚¬λ¥Ό μ„ν•΄ μ‚¬μ©

#### 3) λ°μ΄ν„° μ „μ†΅
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” 4κ°μ μ„Έμ…ν‚¤($E_B, M_B, E_A, M_A$λ¥Ό κ³µμ ν•κ³  μκΈ° λ•λ¬Έμ—, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” TCP μ—°κ²°μ„ ν†µν•΄ μ„λ΅μ—κ² μ•μ „ν• λ°μ΄ν„°λ¥Ό λ³΄λ‚Ό μ μμ
- TCPκ°€ λ°”μ΄νΈ μ¤νΈλ¦Ό ν”„λ΅ν† μ½μ΄λ―€λ΅, TLSκ°€ μ• ν”λ¦¬μΌ€μ΄μ… λ°μ΄ν„°λ¥Ό λμ„μ—†μ΄ μ•”νΈν™”ν•κ³  μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό TCPμ— κ³„μ†μ μΌλ΅ μ „λ‹¬
- TLSλ” λ°μ΄ν„° μ¤νΈλ¦Όμ„ λ μ½”λ“(record) λ‹¨μ„λ΅ μΌκ°κ³  κ° λ μ½”λ“μ— HMACμ„ λ§λ¶™μ—¬ `λ μ½”λ“+HMAC`μ„ μ•”νΈν™”
- HMACμ„ μƒμ„±ν•κΈ° μ„ν•΄ λ μ½”λ“ λ°μ΄ν„°+ν‚¤$M_B$λ¥Ό ν•΄μ‹ ν•¨μμ— λ„£λ”λ‹¤
- λ μ½”λ“+HMACμ„ μ•”νΈν™”ν•κΈ° μ„ν•΄ μ„Έμ… μ•”νΈν™” ν‚¤ $E_B$λ¥Ό μ‚¬μ©
- μ„λ²„λ” μμ„ λ²νΈ μΉ΄μ΄ν„°λ¥Ό μ μ§€ν•  λ• λ μ½”λ“ μμ²΄μ— ν¬ν•¨μ‹ν‚¤λ” κ²ƒμ΄ μ•„λ‹λΌ HMACμ„ κ³„μ‚°ν•  λ• ν¬ν•¨μ‹ν‚΄
    - `HMACν‚¤(M_B) + ν„μ¬ μμ„λ²νΈ`λ¥Ό ν•©μΉ κ²°κ³Όμ ν•΄μ‹κ°’

#### 4) TLS λ μ½”λ“
- TLS λ μ½”λ“λ” `νƒ€μ…`, `λ²„μ „`, `κΈΈμ΄`, `λ°μ΄ν„°`, `HMAC`μ„ κ°€μ§„λ‹¤
- `νƒ€μ…, λ²„μ „, κΈΈμ΄`λ” μ•”νΈν™”λμ§€ μ•κ³ , `λ°μ΄ν„°`μ™€ `HMAC`λ§ μ•”νΈν™”λλ‹¤

### 6.2 TLSμ μ™„μ „ν• κ°λ…
#### 1) TLS handshaking
- TLSλ” νΉμ • λ€μΉ­ν‚¤ μ•κ³ λ¦¬μ¦μ΄λ‚ κ³µκ°ν‚¤ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ„λ΅ κ°•μ ν•μ§€ μ•μ
- TLSλ” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ handshaking λ‹¨κ³„μ—μ„ μ‚¬μ©ν•  μ•”νΈν™” μ•κ³ λ¦¬μ¦μ— ν•©μν•κ² ν•¨
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ„λ΅μ—κ² λ„μ¤λ¥Ό λ³΄λ‚΄κ³ , λ„μ¤λ” μ„Έμ…ν‚¤($E_B, M_B, E_A, M_A$)λ¥Ό μƒμ„±ν•  λ• μ‚¬μ©λ¨

#### 2) TLS handshaking κ³Όμ •
1. ν΄λΌμ΄μ–ΈνΈλ” λ„μ¤μ™€ ν•¨κ» μμ‹ μ΄ μ§€μ›ν•λ” μ•”νΈν™” μ•κ³ λ¦¬μ¦ λ©λ΅μ„ μ†΅μ‹ 
2. μ„λ²„λ” λ©λ΅μΌλ΅λ¶€ν„° λ€μΉ­ν‚¤, κ³µκ°ν‚¤, HMACν‚¤μ™€ ν•¨κ» HMAC μ•κ³ λ¦¬μ¦μ„ μ„ νƒ
    - μ„λ²„λ” μμ‹ μ μ„ νƒ κ²°κ³Όμ™€ μΈμ¦μ„, μ„λ²„ λ„μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µ
3. ν΄λΌμ΄μ–ΈνΈλ” μΈμ¦μ„λ¥Ό ν™•μΈν•κ³ , μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ•μ•„λ‚Έ ν›„ PMS(Pre-Master Secret)μ„ μƒμ„±
    - PMSλ¥Ό μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ μ„λ²„μ—κ² μ „μ†΅
4. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” κ°™μ€ ν‚¤ μ λ„ ν•¨μλ¥Ό μ‚¬μ©ν•΄ PMSμ™€ λ„μ¤λ΅λ¶€ν„° λ…λ¦½μ μΈ MSλ¥Ό κ³„μ‚°
    - MSλ” 2κ°μ μ•”νΈν™” ν‚¤μ™€ 2κ°μ HMAC ν‚¤λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ λ¶„ν• 
    - μ„ νƒλ λ€μΉ­ μ•”νΈν™”κ°€ CBS(3DESλ‚ AES)λ¥Ό μ΄μ©ν•λ‹¤λ©΄ μ–‘μΈ΅μ„ μ„ν•΄ 2κ°μ IV(Initialization Vector)λ¥Ό MSλ΅λ¶€ν„° νλ“
    - μ΄ν›„λ¶€ν„° ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„ λ¨λ“  λ©”μ‹μ§€λ” HMACμ„ μ΄μ©ν•΄ μ•”νΈν™”λκ³  μΈμ¦λ¨
5. ν΄λΌμ΄μ–ΈνΈλ” λ¨λ“  handshake λ©”μ‹μ§€μ HMACμ„ μ „μ†΅
6. μ„λ²„λ” λ¨λ“  handshake λ©”μ‹μ§€μ HMACμ„ μ „μ†΅

#### 3) μ—°κ²° μΆ…λ£
1. λ‹¨μν TCP μ—°κ²°μ„ λμμΌλ΅μ¨ TLS μ„Έμ…μ„ μΆ…λ£ν•κ² ν•¨
    - λ‹¨μν ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² FIN μ”μ²­μ„ λ³΄λƒ„
    - λ¬Έμ  : μ λ‹¨ κ³µκ²© (truncation attack)
        - κ³µκ²©μκ°€ μ„μλ΅ TCP FIN μ”μ²­μ„ λ³΄λ‚΄ μ—°κ²° μ„¤μ •μ„ μΆ…λ£ν•  μ μμ
    - ν•΄κ²° : λ μ½”λ“μ νƒ€μ… ν•„λ“μ— λ μ½”λ“κ°€ TLS μ„Έμ… μΆ…λ£λ¥Ό μν–‰ν•  κ²ƒμΈμ§€λ¥Ό ν‘μ‹
        - λ§μΌ μ„λ²„κ°€ μΆ…λ£ TLS λ μ½”λ“λ¥Ό λ°›κΈ° μ „μ— TCP FINμ„ λ°›κ² λλ©΄ μ΄μƒν•λ‹¤λ” κ²ƒμ„ κ°μ§€ν•¨